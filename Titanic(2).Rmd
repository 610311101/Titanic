---
title: "Data Mining: Titanic(2)"
output: html_notebook
---
從(1)中看到了類別變數的一些概況，延續下去我想看看**Survived**跟這些類別變數的關係，
雖然說是資料探勘啦，但當然還是從簡單畫圖開始，哈哈QQ。
```{r, message=FALSE, warning=FALSE, echo=FALSE}
library("caret");
library("ggplot2");
library("magrittr");
library("plot3D");
library("dplyr");
library("ggpubr");
library("scales");
setwd("C:/Users/hou/Desktop")
Data <- read.csv("Titanic/train.csv",header = T);
#kable(head(Data))
```

---

```{r, echo=FALSE}
##  Survived vs Pclass
Data$Survived <- as.factor(Data$Survived);
Data$Pclass   <- as.factor(Data$Pclass);
Counts <- table(Data$Survived, Data$Pclass);
Percent <- table(Data$Survived, Data$Pclass) %>% apply(1,function(x) x/sum(x) ) %>% t();
Percent <- Percent %>% round(digits = 2);
g1 <- ggplot(Data, aes(x = Survived, fill = Pclass)) +
  geom_bar(stat = "count", width = 0.5, position = "dodge") + 
  ylab("") +
  xlab("") +
  annotate("text", x=1-0.2, y=Counts[1,1], label=  Counts[1,1]) + 
  annotate("text", x=1-0.2, y=10         , label= Percent[1,1]) + 
  annotate("text", x=1-0.0, y=Counts[1,2], label=  Counts[1,2]) +   
  annotate("text", x=1-0.0, y=10         , label= Percent[1,2]) + 
  annotate("text", x=1+0.2, y=Counts[1,3], label=  Counts[1,3]) +
  annotate("text", x=1+0.2, y=10         , label= Percent[1,3]) + 
  annotate("text", x=2-0.2, y=Counts[2,1], label=  Counts[2,1]) +
  annotate("text", x=2-0.2, y=10         , label= Percent[2,1]) +
  annotate("text", x=2-0.0, y=Counts[2,2], label=  Counts[2,2]) +
  annotate("text", x=2-0.0, y=10         , label= Percent[2,2]) +
  annotate("text", x=2+0.2, y=Counts[2,3], label=  Counts[2,3]) +
  annotate("text", x=2+0.2, y=10         , label= Percent[2,3]) + 
  coord_flip();
##  Survived vs Sex
Counts <- table(Data$Survived, Data$Sex);
Percent <- table(Data$Survived, Data$Sex) %>% apply(1,function(x) x/sum(x) ) %>% t();
Percent <- Percent %>% round(digits = 2);

g2 <- ggplot(Data, aes(x = Survived, fill = Sex)) +
  geom_bar(stat = "count", width = 0.5, position = "dodge") + 
  ylab("") +
  xlab("") +
  annotate("text", x=1-0.15, y=Counts[1,1], label=  Counts[1,1]) + 
  annotate("text", x=1-0.15, y=10         , label= Percent[1,1]) +
  annotate("text", x=1+0.15, y=Counts[1,2], label=  Counts[1,2]) + 
  annotate("text", x=1+0.15, y=10         , label= Percent[1,2]) + 
  annotate("text", x=2-0.15, y=Counts[2,1], label=  Counts[2,1]) + 
  annotate("text", x=2-0.15, y=10         , label= Percent[2,1]) + 
  annotate("text", x=2+0.15, y=Counts[2,2], label=  Counts[2,2]) + 
  annotate("text", x=2+0.15, y=10         , label= Percent[2,2]) + 
  coord_flip();
ggarrange(g1, g2,
          labels = c("Survived vs Pclass", "Survived vs Sex"),
          ncol = 2, nrow = 1);
```
**Survived vs Pclass**

 * **3**階層人數最多死得也最多，死掉的人當中有68%來自這個階層。
 * **1**階層人數最後活著的人數最多，存活下來當中有40%來自這個階層。

**Survived vs Sex**

 * 存活下來的人當中有68%是女性。
 * 死亡的人當中有85%來自男性。

---

```{r, echo=FALSE}
##  Survived vs Embarked
Counts <- table(Data$Survived, Data$Embarked);
Percent <- table(Data$Survived, Data$Embarked) %>% apply(1,function(x) x/sum(x) ) %>% t();
Percent <- Percent %>% round(digits = 2);

 ggplot(Data, aes(x = Survived, fill = Embarked)) +
  geom_bar(stat = "count", width = 0.5, position = "dodge") + 
  ylab("") +
  xlab("") + 
  annotate("text", x=1-0.33, y=Counts[1,1], label=  Counts[1,1]) + 
  annotate("text", x=1-0.20, y=Counts[1,2], label=  Counts[1,2]) +   
  annotate("text", x=1-0.20, y=10         , label= Percent[1,2]) + 
  annotate("text", x=1+0.00, y=Counts[1,3], label=  Counts[1,3]) +
  annotate("text", x=1+0.00, y=10         , label= Percent[1,3]) + 
  annotate("text", x=1+0.20, y=Counts[1,4], label=  Counts[1,4]) + 
  annotate("text", x=1+0.20, y=10         , label= Percent[1,4]) + 
  
  annotate("text", x=2-0.18, y=Counts[2,1], label=  Counts[2,1]) + 
  annotate("text", x=2-0.08, y=Counts[2,2], label=  Counts[2,2]) +   
  annotate("text", x=2-0.08, y=10         , label= Percent[2,2]) + 
  annotate("text", x=2+0.05, y=Counts[2,3], label=  Counts[2,3]) +
  annotate("text", x=2+0.05, y=10         , label= Percent[2,3]) + 
  annotate("text", x=2+0.20, y=Counts[2,4], label=  Counts[2,4]) + 
  annotate("text", x=2+0.20, y=10         , label= Percent[2,4]) 
```
**Survived vs Embarked**

 * 大多數人都來自南安普敦港口，所以死亡及存活人數都是最多的。
 * 從皇后鎮上船的人，最後有超過一半的比例活了下來。
 * 2個不知道哪個港口上來的，但最後都存活下來。

---

#### 根據這筆資料簡單的summary：

  * 死掉的人當中：
    + 有68%來自**3**階層。
    + 有18%來自**2**階層。
    + 有15%來自**1**階層。
    + 有85%來自**男性**。
    + 有15%來自**女性**。
    + 有78%來自**S**港口。
    + 有0.9%來自**Q**港口。
    + 有14%來自**C**港口。
    + 有2個不知道哪邊上船的活下來。
  * 這次分析是X|Y的角度(吧)。